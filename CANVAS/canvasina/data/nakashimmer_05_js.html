//初期設定////////   
kosu=10000;			//星の個数は1万
var hoshi=new Array(kosu);	//星を1万作成。
for(var i=0;i<kosu;i++){				//hoshi[0]〜hoshi[9999]まで順番に
	var j=ransu(kosu)/kosu*500;			//0~500までのx,y軸上に星の位置を指定
	hoshi[i]={
		x:j,y:j + Math.tan(i)*50, r:1,
		color:"rgb("+ransu(90)+10+"%,"
		+ransu(90)+10+"%,"
		+ransu(90)+10+"%)"
	};
}

var nagareboshi={x:-10,y:10}; 
var frame=0;

//アニメーション////
setInterval(anime,50);		//タイマー
var frame=0;				//コマのカウント
function anime(){
	frame++;	
	if(frame>kosu)frame=kosu;				
	shikaku(0,0,500,500,"#333");				
	for(var i=0;i<frame;i++){
	en(hoshi[i].x,　hoshi[i].y,hoshi[i].r+ransu(2),
	0,2*pi,hoshi[i].color);
	}
	
	if(frame%300===100){						
		nagareboshi.x=500;	
		nagareboshi.y=ransu(250);
 }
 nagareboshi.x -=3;	
 nagareboshi.y +=1;	
 en(	nagareboshi.x,nagareboshi.y,1,0,2*pi,"white");       
 
 //織姫(350,150)
 c.save();
 c.translate(350,150);
 shikaku(	-50,  0,100,80,"black");  			//後ろ髪
 enshu(		  0,-10, 90, 0,2*pi,"yellow",5);     	//衣
 en(	 	  0, 70, 40, 0,2*pi,"pink");     	//肩
 sankaku(	  0, 30,120,40,"pink");   			//体
 shikaku(	-20, 60, 40,20,"red");    			//帯
 sankaku(	  0, 45,-20,20,"red");    			//襟
 en(		  0,  0, 35, 0,2*pi,"FFE6CE");  		//顔の輪郭
 en(		  0,  0, 50,pi,2*pi,"black");   		//前髪
 en(		-20,  8,  5, 0,2*pi,"black");   		//目
 en(		 20,  8,  5, 0,2*pi,"black");   		//目
 enshu(		  0, 10, 15,1/3*pi,2/3*pi,"red",1); 	//口 
 txt("★",	-20,-20,"yellow",50);     			//星
 c.restore();
  
 //彦星(150,250)
  c.save();
  c.translate(150,250);
 en(		-40, 80, 10, 0,2*pi,"white");   //手
 en(		 40, 80, 10, 0,2*pi,"white");   //手
 en(		  0, 80, 50,pi,2*pi,"lightblue");      //肩
 sankaku(	  0, 30, 80,40,"lightblue");      //体
 shikaku(	-25,100, 20,50,"lightblue");      //足    
 shikaku(	  5,100, 20,50,"lightblue");      //足    
 shikaku(	-20, 60, 40,20,"blue");    //帯
 en(		  0,  0, 39, 0,2*pi,"FFE6CE");  //顔の輪郭
 en(		  0,  0, 40,pi,2*pi,"black");   //髪
 en(		 10,-50, 20, 0,2*pi,"black");   //髪
 en(		-20,  8,  5, 0,2*pi,"black");   //目
 en(		 20,  8,  5, 0,2*pi,"black");   //目
 enshu(		  0, 10, 15,1/3*pi,2/3*pi,"red",1); //口 
 txt("★",	-20,100,"yellow",10);     //星
  c.restore();     

 
 }

//π（円周率）
	var pi=Math.PI;

//乱数
function ransu(r){
	return　Math.floor(Math.random()*r);
}

//長方形（矩形）
function shikaku(x,y,w,h,color){
  	c.fillStyle=color;
	c.fillRect(x,y,w,h);
}

//三角（多角形）
function sankaku(x,y,h,w,color){
  	c.beginPath();
	c.moveTo(x,y);
	c.lineTo(x+w,y+h);
	c.lineTo(x-w,y+h);
	c.closePath();
	c.fillStyle=color;
	c.fill();
}

//塗りつぶし円
function en(x,y,r,start,end,color){
	c.beginPath();
	c.arc(x,y,r,start,end,false);
	c.fillStyle=color;
	c.fill();
}

//円周枠
function enshu(x,y,r,start,end,color,width){
	c.beginPath();
	c.arc(x,y,r,start,end,false);
	c.lineWidth=width;
	c.strokeStyle=color;
	c.stroke();
}

//テキスト
function txt(str,x,y,color,px){
	c.font=px+"px 'arial'";
	c.fillStyle=color;
	c.fillText(str,x,y);
}