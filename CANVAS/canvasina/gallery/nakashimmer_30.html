<!DOCTYPE html>
<meta charset=utf-8>
<meta name="viewport" content="width=500">
<title>Merry Xmas! created by nakashimmer | Canvasina is HTML5 art scripting gallery</title>
<meta name=description content="Merry Xmas! created by nakashimmer | Canvasina.com is HTML5 art scripting gallery">
<link href="../canvasina/canvasina.css" rel=stylesheet>
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- for  facebook like button -->
<div id="fb-root"></div>
<script>
(function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0];if(d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;js.src = "//connect.facebook.net/ja_JP/all.js#xfbml=1&appId=141558212660855";
  fjs.parentNode.insertBefore(js, fjs);}(document, 'script', 'facebook-jssdk'));
</script>
<!-- facebook like button -->

<section id=wrap>
	
	<section>
		<canvas id=canvasina width=500 height=450>
			Sorry, Your browser is not chrome ,safari.
			<img src=http://canvasina.com/img/icon.png height=225><br>
			<img src=http://canvasina.com/galleryImg/nakashimmer_30.png height=225>
		</canvas>
	
	</section>

	<header>
		Merry Xmas!
	</header>

	<footer>
		<a href="http://www.facebook.com/nakashimmer" target=_blank>created by Shunji Nakashima</a>
		<a href="/" ><h1>Canvasina</h1></a>
		
		<a id=share href="https://www.facebook.com/sharer/sharer.php?u=http://canvasina.com/gallery/nakashimmer_30.html" target="_blank">Share</a>

		<!-- a id=share name="fb_share" type="button_count" share_url="http://canvasina.com/gallery/nakashimmer_30.html"></a>
		<script src="http://static.ak.fbcdn.net/connect.php/js/FB.Share" type="text/javascript"></script -->
		
		<div id=like style="" class="fb-like" data-href="http://canvasina.com/gallery/nakashimmer_30.html" data-width="100" 
		data-colorscheme="dark" data-layout="button_count" data-show-faces="false" data-send="false"></div>
		
	</footer>	
</section>

<script src="../canvasina/canvasina.js"></script>
<script>
//初期設定

var kashi=[
"Silent night",
"holy night!",
"All is calm",
"all is bright",
"Round yon Virgin",
"Mother and Child",
"Holy infant so",
"tender and mild",
"Sleep in heavenly peace",
"Sleep in heavenly peace",
"Sleep in heavenly peace",
"Sleep in heavenly peace"
]

var frame=0;
var yuki = new Array();
for(i=0;i<100;i++){
	yuki[i]={
		x:Math.floor(Math.random()*500),
		y:-i*5
	};
}
var sound=new Audio("http://springreen.jp/INDEX/themes/ShunsuiKobo/kiyoshi.mp3");
if(canvas.getBoundingClientRect().left>0){
sound.play();
}
var bg=c.createLinearGradient(0,0,0,canvas.height);
bg.addColorStop(0,"black");
bg.addColorStop(1,"white");

  WebFontConfig = {
    google: { families: [ 'Redressed::latin' ] }
  };
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })();

//メインプログラム
setInterval(anime,100);
function anime(){
	frame+=3;
	//クリア
	c.fillStyle=bg;
	c.fillRect(0,0,canvas.width,canvas.height);
	//描画
	
	trunk(250,350);

	branch(250,150, 250-50-150,350, 250+50+150,350);
	branch(250,100, 250-50- 70,250, 250+50+ 70,250);
	branch(250, 50, 250-50-  0,130, 250+50+  0,130);

	
	star(250,13,0,1,"gold",0);

	
	ball(200,200,10,"blue");
	ball(250,290,10,"blue");
	ball(330,250,10,"blue");

	ball(200-30,200+20,10,"red");
	ball(250-20,290+30,10,"red");
	ball(330-30,250+20,10,"red");

	ball(200+20,200+30,10,"yellow");
	ball(250+30,290+20,10,"yellow");
	ball(330+20,250+30,10,"yellow");

	star(150,290,10,0.5,"pink",120);
	star(270,190,-10,0.5,"skyblue",120);
	star(350,300,0,0.5,"red",120);

	moll(140,260,210,320,330,200);

	snow();
	msg("Merry Xmas to all",250,250,"white");

var count=Math.floor(sound.currentTime/(sound.duration-3)*12)+1;
if(count>=12)count=12;
c.fillStyle="yellow";
msg(kashi[count-1],250,100,"yellow");

}

//関数定義


function branch(x,y,x1,y1,x2,y2){ //多角形

	var branchColor=c.createLinearGradient(x,y,x,y1);
	branchColor.addColorStop(0.5,"#006600");
	branchColor.addColorStop(1,"#33aa33");
	c.beginPath();
	c.moveTo(x,y);
	c.lineTo(x1,y1);
	c.lineTo(x2,y2);
	c.closePath();
	c.fillStyle=branchColor;
	c.globalAlpha=1;
	c.fill();
}

function trunk(x,y){		    //矩形
	c.fillStyle = "brown";
	c.fillRect(x-50,y-50,100,100);
}

function snow(){
	for(i=0;i<yuki.length;i++){   //円弧
		c.beginPath();
		c.arc(yuki[i].x,yuki[i].y,
			3,0,2*Math.PI,true);
		c.fillStyle="white";
		c.fill();
		//計算
		yuki[i].x +=Math.floor(
			Math.random()*3)-1;
		yuki[i].y +=1+Math.floor(
			Math.random()*2);
		if(canvas.height+5<yuki[i].y)
			{yuki[i].y=-5;}
	}
}


function msg(str,x,y,color){			//テキスト
	c.fillStyle=color
	c.font="50px Redressed";
	c.textAlign="center";
	c.fillText(str,x,y);
	c.globalAlpha=1;
}

function wreath(x,y,r){		      //円
	c.beginPath();
	c.arc(x,y,r,0,2*Math.PI,false);
	c.closePath();
	c.lineWidth=100;
	c.strokeStyle="green"
	c.stroke();
}

function star(x,y,deg,s,color,delay){	     //変形+多角形
	c.save();
	c.translate(x,y);
	c.rotate(deg/180*Math.PI);
	c.scale(s,s)
	c.beginPath();
	c.moveTo(0,0);
	c.lineTo(-20,50);
	c.lineTo(30,20);
	c.lineTo(-30,20);
	c.lineTo(20,50);
	c.fillStyle=color;
	c.globalAlpha = Math.abs(Math.sin((frame+delay)/180*Math.PI))+0.4;
	c.fill();
	c.restore();
}

function ball(x,y,r,color){	     //円
	c.beginPath();
	c.arc(x,y,r,0,2*Math.PI,false);
	c.closePath();
c.globalAlpha = Math.abs(Math.sin((frame+240)/180*Math.PI))+0.4;
	c.fillStyle=color;

	c.fill();
c.globalAlpha=1;
}


function ribbon(x,y){	     //多角形+矩形
	c.beginPath();
	c.moveTo(x-60,y-30);
	c.lineTo(x-60,y+30);
	c.lineTo(x+60,y-30);
	c.lineTo(x+60,y+30);
	c.closePath();
	c.fillStyle="red";
	c.lineWidth=1;
	c.strokeStyle="white";
	c.fill();
	c.stroke();
	c.fillRect(x-25,y-15,50,30);
	c.strokeRect(x-25,y-15,50,30);
}
function bell(x,y){	     //変形+多角形
	c.save();
	c.translate(x,y);
	c.rotate(80*Math.sin(
		frame/10)/180*Math.PI);
	c.beginPath();
	c.moveTo(0,0);
	c.lineTo(-20,15);
	c.lineTo(-40,75);
	c.lineTo(40,75);
	c.lineTo(20,15);
	c.closePath();
	c.fillStyle="Gold";
	c.fill();
	c.lineWidth=1;
	c.strokeStyle="white";
	c.stroke();
	c.restore();
}

function moll(x,y,x1,y1,x2,y2){
	c.beginPath();
	c.moveTo(x,y);
	c.quadraticCurveTo(x1,y1,x2,y2);
	c.strokeStyle="white";
	c.lineWidth=10;
	c.lineCap="round";
	c.globalAlpha=0.7;
	c.stroke();
	c.globalAlpha=1;
}
</script>

<script type="text/javascript">
if (window==parent){
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-3233827-64']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
}
</script>
