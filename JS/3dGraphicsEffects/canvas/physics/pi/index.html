<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>PI</title>
		<meta name="viewport" content="width=device-width">
		<link rel="stylesheet" href="../../../../../sample.css">
		<style>
			#canvas{
				display:block;
				margin:0 auto;
				top:0;left:0;
				border:1px solid black;
			}


			#info{
				width:400px;
				margin:1em auto;
				border-style:solid;
				border-color:gray;
				border-width:0 1px 1px 0;
			}
			
			#info tr{display:flex;}
			#info th,#info td{
				flex:1;
				padding:0.5em;
				border-style:solid;
				border-color:gray;
				border-width:1px 0 0 1px;
				min-height:2em;
			}
			td{
				text-align:right;
			}

		</style>
	</head>

	<body>
		<h1>円周率の計算(モンテカルロ法)</h1>
		<div id="wrap">
			<canvas id="canvas" width="400" height="400"></canvas>

			<table id="info">
				<tr>
					<th>ヒット(1)</th><td id="hit"></td>
				</tr>
				<tr>
					<th>トータル(2)</th><td id="total"></td>
				</tr>
				<tr>
					<th>4*(1)/(2)</th><td id="cal"></td>
				</tr>
				<tr>
					<th>πとの差</th><td id="gosa"></td>
				</tr>

			</table>
		</div>
	
		<footer>
			<p><small>(C)<a href="https://tokyoappwork.shop">東京アプリ・ワークショップ</a>・<a href="https://webtechpromo.org">Web技術振興協会</a></small></p>
		</footer>
	
		<script>
			const CANVAS = document.getElementById("canvas");
			const CTX = CANVAS.getContext("2d");
			const sound = new Audio("gatling.mp3");
			const HIT = document.getElementById("hit");
			const TOTAL = document.getElementById("total");
			const CAL = document.getElementById("cal");
			const GOSA = document.getElementById("gosa");

			CTX.beginPath();
			CTX.arc(200,200,200,0,2*Math.PI);
			CTX.lineWidth=5;
			CTX.strokeStyle="rgba(0,0,0,0.5)";
			CTX.stroke();

			
			let hit = 0; //円内の数
			let total = 0;　//試行回数
			let w = 40;	//マークの大きさ

			CANVAS.addEventListener("click",()=>{
				sound.currentTime=0;
				sound.play();

				let x　=　Math.random()*400;
				let y　=　Math.random()*400;
				
				let color="rgba("
					+Math.floor(Math.random()*(255/3)*3)+","
					+Math.floor(Math.random()*(255/3)*3)+","
					+Math.floor(Math.random()*(255/3)*3)+",1"
				+")";

				CTX.save();
				CTX.beginPath();
				CTX.translate(Math.floor(x),Math.floor(y));
				CTX.rotate(Math.random()*2*Math.PI);
				CTX.font = w+"px serif";
				CTX.strokeStyle = "white";
				CTX.lineWidth = 1;
				CTX.strokeText("★",-w/2+1,w/2+1);
				CTX.fillStyle = color;

				CTX.fillText("★",-w/2,+w/2);
				CTX.restore();

				total++;

				if(Math.pow(x-200,2)+Math.pow(y-200,2)<Math.pow(200,2)){
					hit++;
				}
				HIT.innerHTML = hit; 
				TOTAL.innerHTML = total;
				CAL.innerHTML = hit/total*4;
				GOSA.innerHTML = Math.abs(100-(hit/total*4)/Math.PI*100).toFixed(3)+"%";
			});




		</script>



	</body>
</html>